package processm.enhancement.kpi.timeseries

import java.util.*
import kotlin.collections.ArrayList

object TSAFCSeries {
    /**
     * [TSAFC] page 626
     */
    private val seriesAText = """
        1 17.0 41 17.6 81 16.8 121 16.9 161 17.1
        2 16.6 42 17.5 82 16.7 122 17.1 162 17.1
        3 16.3 43 16.5 83 16.4 123 16.8 163 17.1
        4 16.1 44 17.8 84 16.5 124 17.0 164 17.4
        5 17.1 45 17.3 85 16.4 125 17.2 165 17.2
        6 16.9 46 17.3 86 16.6 126 17.3 166 16.9
        7 16.8 47 17.1 87 16.5 127 17.2 167 16.9
        8 17.4 48 17.4 88 16.7 128 17.3 168 17.0
        9 17.1 49 16.9 89 16.4 129 17.2 169 16.7
        10 17.0 50 17.3 90 16.4 130 17.2 170 16.9
        11 16.7 51 17.6 91 16.2 131 17.5 171 17.3
        12 17.4 52 16.9 92 16.4 132 16.9 172 17.8
        13 17.2 53 16.7 93 16.3 133 16.9 173 17.8
        14 17.4 54 16.8 94 16.4 134 16.9 174 17.6
        15 17.4 55 16.8 95 17.0 135 17.0 175 17.5
        16 17.0 56 17.2 96 16.9 136 16.5 176 17.0
        17 17.3 57 16.8 97 17.1 137 16.7 177 16.9
        18 17.2 58 17.6 98 17.1 138 16.8 178 17.1
        19 17.4 59 17.2 99 16.7 139 16.7 179 17.2
        20 16.8 60 16.6 100 16.9 140 16.7 180 17.4
        21 17.1 61 17.1 101 16.5 141 16.6 181 17.5
        22 17.4 62 16.9 102 17.2 142 16.5 182 17.9
        23 17.4 63 16.6 103 16.4 143 17.0 183 17.0
        24 17.5 64 18.0 104 17.0 144 16.7 184 17.0
        25 17.4 65 17.2 105 17.0 145 16.7 185 17.0
        26 17.6 66 17.3 106 16.7 146 16.9 186 17.2
        27 17.4 67 17.0 107 16.2 147 17.4 187 17.3
        28 17.3 68 16.9 108 16.6 148 17.1 188 17.4
        29 17.0 69 17.3 109 16.9 149 17.0 189 17.4
        30 17.8 70 16.8 110 16.5 150 16.8 190 17.0
        31 17.5 71 17.3 111 16.6 151 17.2 191 18.0
        32 18.1 72 17.4 112 16.6 152 17.2 192 18.2
        33 17.5 73 17.7 113 17.0 153 17.4 193 17.6
        34 17.4 74 16.8 114 17.1 154 17.2 194 17.8
        35 17.4 75 16.9 115 17.1 155 16.9 195 17.7
        36 17.1 76 17.0 116 16.7 156 16.8 196 17.2
        37 17.6 77 16.9 117 16.8 157 17.0 197 17.4
        38 17.7 78 17.0 118 16.3 158 17.4
        39 17.4 79 16.6 119 16.6 159 17.2
        40 17.8 80 16.7 120 16.8 160 17.2
    """.trimIndent()

    /**
     * [TSAFC] page 627
     */
    private val seriesBText = """
        460 471 527 580 551 523 333 394 330
        457 467 540 579 551 516 330 393 340
        452 473 542 584 552 511 336 409 339
        459 481 538 581 553 518 328 411 331
        462 488 541 581 557 517 316 409 345
        459 490 541 577 557 520 320 408 352
        463 489 547 577 548 519 332 393 346
        479 489 553 578 547 519 320 391 352
        493 485 559 580 545 519 333 388 357
        490 491 557 586 545 518 344 396
        492 492 557 583 539 513 339 387
        498 494 560 581 539 499 350 383
        499 499 571 576 535 485 351 388
        497 498 571 571 537 454 350 382
        496 500 569 575 535 462 345 384
        490 497 575 575 536 473 350 382
        489 494 580 573 537 482 359 383
        478 495 584 577 543 486 375 383
        487 500 585 582 548 475 379 388
        491 504 590 584 546 459 376 395
        487 513 599 579 547 451 382 392
        482 511 603 572 548 453 370 386
        479 514 599 577 549 446 365 383
        478 510 596 571 553 455 367 377
        479 509 585 560 553 452 372 364
        477 515 587 549 552 457 373 369
        479 519 585 556 551 449 363 355
        475 523 581 557 550 450 371 350
        479 519 583 563 553 435 369 353
        476 523 592 564 554 415 376 340
        476 531 592 567 551 398 387 350
        478 547 596 561 551 399 387 349
        479 551 596 559 545 361 376 358
        477 547 595 553 547 383 385 360
        476 541 598 553 547 393 385 360
        475 545 598 553 537 385 380 366
        475 549 595 547 539 360 373 359
        473 545 595 550 538 364 382 356
        474 549 592 544 533 365 377 355
        474 547 588 541 525 370 376 367
        474 543 582 532 513 374 379 357
        465 540 576 525 510 359 386 361
        466 539 578 542 521 335 387 355
        467 532 589 555 521 323 386 348
        471 517 585 558 521 306 389 343
    """.trimIndent()

    /**
     * [TSAFC] page 628
     */
    private val seriesBprimText = """
        445 425 406 441 415 461
        448 421 407 437 420 463
        450 414 410 427 420 463
        447 410 408 423 424 461
        451 411 408 424 426 465
        453 406 409 428 423 473
        454 406 410 428 423 473
        454 413 409 431 425 475
        459 411 405 425 431 499
        440 410 406 423 436 485
        446 405 405 420 436 491
        443 409 407 426 440 496
        443 410 409 418 436 504
        440 405 407 416 443 504
        439 401 409 419 445 509
        435 401 425 418 439 511
        435 401 425 416 443 524
        436 414 428 419 445 525
        435 419 436 425 450 541
        435 425 442 421 461 531
        435 423 442 422 471 529
        433 411 433 422 467 530
        429 414 435 417 462 531
        428 420 433 420 456 527
        425 412 435 417 464 525
        427 415 429 418 463 519
        425 412 439 419 465 514
        422 412 437 419 464 509
        409 411 439 417 456 505
        407 412 438 419 460 513
        423 409 435 422 458 525
        422 407 433 423 453 519
        417 408 437 422 453 519
        421 415 437 421 449 522
        424 413 444 421 447 522
        414 413 441 419 453
        419 410 440 418 450
        429 405 441 421 459
        426 410 439 420 457
        425 412 439 413 453
        424 413 438 413 455
        425 411 437 408 453
        425 411 441 409 450
        424 409 442 415 456
    """.trimIndent()

    /**
     * [TSAFC] page 629
     */
    private val seriesCText = """
        26.6 19.6 24.4 21.1 24.4
        27.0 19.6 24.4 20.9 24.2
        27.1 19.6 24.4 20.8 24.2
        27.1 19.6 24.4 20.8 24.1
        27.1 19.6 24.5 20.8 24.1
        27.1 19.7 24.5 20.8 24.0
        26.9 19.9 24.4 20.9 24.0
        26.8 20.0 24.3 20.8 24.0
        26.7 20.1 24.2 20.8 23.9
        26.4 20.2 24.2 20.7 23.8
        26.0 20.3 24.0 20.7 23.8
        25.8 20.6 23.9 20.8 23.7
        25.6 21.6 23.7 20.9 23.7
        25.2 21.9 23.6 21.2 23.6
        25.0 21.7 23.5 21.4 23.7
        24.6 21.3 23.5 21.7 23.6
        24.2 21.2 23.5 21.8 23.6
        24.0 21.4 23.5 21.9 23.6
        23.7 21.7 23.5 22.2 23.5
        23.4 22.2 23.7 22.5 23.5
        23.1 23.0 23.8 22.8 23.4
        22.9 23.8 23.8 23.1 23.3
        22.8 24.6 23.9 23.4 23.3
        22.7 25.1 23.9 23.8 23.3
        22.6 25.6 23.8 24.1 23.4
        22.4 25.8 23.7 24.6 23.4
        22.2 26.1 23.6 24.9 23.3
        22.0 26.3 23.4 24.9 23.2
        21.8 26.3 23.2 25.1 23.3
        21.4 26.2 23.0 25.0 23.3
        20.9 26.0 22.8 25.0 23.2
        20.3 25.8 22.6 25.0 23.1
        19.7 25.6 22.4 25.0 22.9
        19.4 25.4 22.0 24.9 22.8
        19.3 25.2 21.6 24.8 22.6
        19.2 24.9 21.3 24.7 22.4
        19.1 24.7 21.2 24.6 22.2
        19.0 24.5 21.2 24.5 21.8
        18.9 24.4 21.1 24.5 21.3
        18.9 24.4 21.0 24.5 20.8
        19.2 24.4 20.9 24.5 20.2
        19.3 24.4 21.0 24.5 19.7
        19.3 24.4 21.0 24.5 19.3
        19.4 24.3 21.1 24.5 19.1
        19.5 24.4 21.2 24.4 19.0
        _    _    _    _    18.8
    """.trimIndent()

    /**
     * [TSAFC] page 630
     */
    private val seriesDText = """
        8.0 8.8 9.3 9.1 9.0 10.0 9.6
        8.0 8.6 9.9 9.5 9.0 9.8 8.6
        7.4 8.6 9.7 9.4 9.4 9.8 8.0
        8.0 8.4 9.1 9.5 9.0 9.7 8.0
        8.0 8.3 9.3 9.6 9.0 9.6 8.0
        8.0 8.4 9.5 10.2 9.4 9.4 8.0
        8.0 8.3 9.4 9.8 9.4 9.2 8.4
        8.8 8.3 9.0 9.6 9.6 9.0 8.8
        8.4 8.1 9.0 9.6 9.4 9.4 8.4
        8.4 8.2 8.8 9.4 9.6 9.6 8.4
        8.0 8.3 9.0 9.4 9.6 9.6 9.0
        8.2 8.5 8.8 9.4 9.6 9.6 9.0
        8.2 8.1 8.6 9.4 10.0 9.6 9.4
        8.2 8.1 8.6 9.6 10.0 9.6 10.0
        8.4 7.9 8.0 9.6 9.6 9.6 10.0
        8.4 8.3 8.0 9.4 9.2 9.0 10.0
        8.4 8.1 8.0 9.4 9.2 9.4 10.2
        8.6 8.1 8.0 9.0 9.2 9.4 10.0
        8.8 8.1 8.6 9.4 9.0 9.4 10.0
        8.6 8.4 8.0 9.4 9.0 9.6 9.6
        8.6 8.7 8.0 9.6 9.6 9.4 9.0
        8.6 9.0 8.0 9.4 9.8 9.6 9.0
        8.6 9.3 7.6 9.2 10.2 9.6 8.6
        8.6 9.3 8.6 8.8 10.0 9.8 9.0
        8.8 9.5 9.6 8.8 10.0 9.8 9.6
        8.9 9.3 9.6 9.2 10.0 9.8 9.6
        9.1 9.5 10.0 9.2 9.4 9.6 9.0
        9.5 9.5 9.4 9.6 9.2 9.2 9.0
        8.5 9.5 9.3 9.6 9.6 9.6 8.9
        8.4 9.5 9.2 9.8 9.7 9.2 8.8
        8.3 9.5 9.5 9.8 9.7 9.2 8.7
        8.2 9.5 9.5 10.0 9.8 9.6 8.6
        8.1 9.9 9.5 10.0 9.8 9.6 8.3
        8.3 9.5 9.9 9.4 9.8 9.6 7.9
        8.4 9.7 9.9 9.8 10.0 9.6 8.5
        8.7 9.1 9.5 8.8 10.0 9.6 8.7
        8.8 9.1 9.3 8.8 8.6 9.6 8.9
        8.8 8.9 9.5 8.8 9.0 10.0 9.1
        9.2 9.3 9.5 8.8 9.4 10.0 9.1
        9.6 9.1 9.1 9.6 9.4 10.4 9.1
        9.0 9.1 9.3 9.6 9.4 10.4
        8.8 9.3 9.5 9.6 9.4 9.8
        8.6 9.5 9.3 9.2 9.4 9.0
        8.6 9.3 9.1 9.2 9.6 9.6
        8.8 9.3 9.3 9.0 10.0 9.8
    """.trimIndent()

    /**
     * [TSAFC] page 631
     */
    private val seriesEText = """
        1770 101 1795 21 1820 16 1845 40
        1771 82 1796 16 1821 7 1846 62
        1772 66 1797 6 1822 4 1847 98
        1773 35 1798 4 1823 2 1848 124
        1774 31 1799 7 1824 8 1849 96
        1775 7 1800 14 1825 17 1850 66
        1776 20 1801 34 1826 36 1851 64
        1777 92 1802 45 1827 50 1852 54
        1778 154 1803 43 1828 62 1853 39
        1779 125 1804 48 1829 67 1854 21
        1780 85 1805 42 1830 71 1855 7
        1781 68 1806 28 1831 48 1856 4
        1782 38 1807 10 1832 28 1857 23
        1783 23 1808 8 1833 8 1858 55
        1784 10 1809 2 1834 13 1859 94
        1785 24 1810 0 1835 57 1860 96
        1786 83 1811 1 1836 122 1861 77
        1787 132 1812 5 1837 138 1862 59
        1788 131 1813 12 1838 103 1863 44
        1789 118 1814 14 1839 86 1864 47
        1790 90 1815 35 1840 63 1865 30
        1791 67 1816 46 1841 37 1866 16
        1792 60 1817 41 1842 24 1867 7
        1793 47 1818 30 1843 11 1868 37
        1794 41 1819 24 1844 15 1869 74
    """.trimIndent()

    /**
     * [TSAFC] page 631
     */
    private val seriesFText = """
        47 44 50 62 68
        64 80 71 44 38
        23 55 56 64 50
        71 37 74 43 60
        38 74 50 52 39
        64 51 58 38 59
        55 57 45 59 40
        41 50 54 55 57
        59 60 36 41 54
        48 45 54 53 23
        71 57 48 49
        35 50 55 34
        57 45 45 35
        40 25 57 54
        58 59 50 45
    """.trimIndent()

    private val tokenSeparator = Regex("\\s+")

    private fun parseWithIndex(text: String): List<Double> {
        val data = ArrayList<Pair<Int, Double>>()
        for (line in text.lineSequence()) {
            val tokens = line.trim().split(tokenSeparator)
            check(tokens.size % 2 == 0)
            (tokens.indices step 2).mapTo(data) { i -> Integer.parseInt(tokens[i]) to tokens[i + 1].toDouble() }
        }
        data.sortBy { it.first }
        return data.map { it.second }
    }

    private fun parseColumns(text: String): List<Double> {
        val columns = ArrayList<ArrayList<Double>>()
        for (line in text.lineSequence()) {
            val tokens = line.trim().split(tokenSeparator)
            tokens.forEachIndexed { idx, token ->
                if (token != "_") {
                    while (idx >= columns.size)
                        columns.add(ArrayList())
                    columns[idx].add(token.toDouble())
                }
            }
        }
        return columns.flatten()
    }

    val seriesA: List<Double> by lazy {
        Collections.unmodifiableList(parseWithIndex(seriesAText))
    }

    val seriesB: List<Double> by lazy {
        Collections.unmodifiableList(parseColumns(seriesBText))
    }

    val seriesBprim: List<Double> by lazy {
        Collections.unmodifiableList(parseColumns(seriesBprimText))
    }

    val seriesC: List<Double> by lazy {
        Collections.unmodifiableList(parseColumns(seriesCText))
    }

    val seriesD: List<Double> by lazy {
        Collections.unmodifiableList(parseColumns(seriesDText))
    }

    val seriesE: List<Double> by lazy {
        Collections.unmodifiableList(parseWithIndex(seriesEText))
    }

    val seriesF: List<Double> by lazy {
        Collections.unmodifiableList(parseColumns(seriesFText))
    }

}

